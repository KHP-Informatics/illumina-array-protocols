{"name":"Illumina-array-protocols","tagline":"processing illumina SNP arrays","body":"# [illumina](http://www.illumina.com/)-array-protocols\r\n\r\n**Protocols/scripts for processing illumina SNP arrays**  \r\n\r\n**VERSION: v0.1**  \r\n\r\nA set of scripts and protocols that we use to processing raw Illumina SNP array data.\r\n\r\n- BWA Mapping of probe sequences  \r\n- Genomestudio SOP (Manual Calling & QC)    \r\n- Standard QC (PLINK, bash...) and re-calling No-Calls using zCall  \r\n\r\n## The Team \r\n**Bioinformatics** - Hamel Patel, Amos Folarin & Stephen Newhouse  @ [bluecell.io]()   \r\n**Lab** - Charles Curtis & Team @ [The IoPPN Genomics & Biomarker Core Facility](http://www.kcl.ac.uk/ioppn/depts/mrc/research/The-IoPPN-Genomics--Biomarker-Core-Facility.aspx)  \r\n\r\n![illuminaCSPro](./figs/CSProLogo-new-Cropped-313x105.png)\r\n\r\n## Illumina Downloads Resource\r\nThis links takes you to Illumina's download page, which provides access to product documentation and\r\nmanifests.\r\n\r\n- [Illumina Downloads](http://support.illumina.com/downloads.html)\r\n\r\n## BeadChips\r\nThese are the BeadChips we have experience in processing so far....\r\n\r\n| Array |\r\n|-------|\r\n|[HumanOmniExpress-24 v1.0 BeadChip](http://support.illumina.com/downloads/humanomniexpress-24-v1-0-product-files.html) | \r\n|[HumanOmniExpress-24 v1.1 BeadChip](http://support.illumina.com/downloads/humanomniexpress-24-v1-0-product-files.html)  |\r\n|[HumanCoreExome-24 v1.0 BeadChip](http://support.illumina.com/downloads/humancoreexome-24-v1-0-product-files.html)  |\r\n|[HumanOmniExpressExome-8 v1.1 BeadChip](http://support.illumina.com/downloads/humanomniexpressexome-8v1-1_product_files.html)   |\r\n|[MEGA\\_Consortium](link) (Early Access...)|\r\n\r\n## 1. BWA Mapping of Probe Sequences\r\n\r\nIllumina SNP arrays include a lot of probes that map to multiple (>500) sites in the Genome.  \r\n\r\nFor each array we map the probe sequences to the relevant genome build using BWA (as indicated by Illumina manifests), and\r\nidentify probes that map 100% to multiple regions (>1 hit) of the genome.\r\n\r\nThese probes are either flagged for removal before re-calling, or depending on what the data looks likes in Genomestudio,\r\nare zeroed at the Genomestudio stage before clustering.  \r\n\r\nThose familiar with processing Illumina Arrays, will see that a lot of the probes we identify are consitently poorly clustered variants, variants not called for alot of samples, and those messy clouds and/or the always homozygous variants - no matter the population or number of samples. \r\n\r\nMore details soon....  \r\n\r\n### Illumina Array Annotations\r\n\r\n| Array | Download Link |\r\n|-------|---------------|\r\n|MEGA\\_Consortium\\_15063755_B2.csv | [download](https://s3-eu-west-1.amazonaws.com/illumina-probe-mappings/mega_array_annotations.txt.gz) |\r\n|HumanCoreExome\\-24v1\\-0\\_A.csv |[download](ftp://webdata:webdata@ussd-ftp.illumina.com/Downloads/ProductFiles/HumanCoreExome-24/Product_Files/HumanCoreExome-24v1-0_A.csv) |\r\n|HumanOmniExpressExome\\-8\\-v1\\-1\\-C.csv | [download](ftp://webdata:webdata@ussd-ftp.illumina.com/Downloads/ProductFiles/HumanOmniExpressExome/v1-1/HumanOmniExpressExome-8-v1-1-C.csv) |\r\n| XXX |[download]()|\r\n| XXX |[download]()|\r\n| XXX |[download]()|\r\n\r\n### BWA Mapping Results \r\n\r\n**Running BWA**  \r\nUsing [NGSeasy](https://github.com/KHP-Informatics/ngseasy) Docker [compbio/ngseasy-bwa](https://registry.hub.docker.com/u/compbio/ngseasy-bwa/) image.\r\n\r\n>Program: bwa (alignment via Burrows-Wheeler transformation)  \r\n>Version: 0.7.12-r1039  \r\n>Contact: Heng Li <lh3@sanger.ac.uk>  \r\n\r\n```bash\r\n###################################\r\n## BWA > samblaster > samtools\r\n#\r\n\r\narray=\"\"\r\nrefGenome=\"\"\r\n\r\ndocker run \\\r\n-w /home/pipeman \\\r\n-e HOME=/home/pipeman \\\r\n-e USER=pipeman \\\r\n--user pipeman \\\r\n-i \\\r\n-t compbio/ngseasy-bwa:1.0 /bin/bash -c \\\r\n\"bwa mem -t 32 -V -M -a ${refGenome} ${array}.fasta | \\\r\nsamblaster --addMateTags --excludeDups | \\\r\nsamtools sort -@ 32 -T temp_ -O sam -o ${array}.sam && \\\r\nsamtools index ${array}.sam && \\\r\nrm ${array}.sam\"\r\n```\r\n\r\n**MEGA**    \r\n- [mega_array_seq_sorted.bam](https://s3-eu-west-1.amazonaws.com/illumina-probe-mappings/mega_array_seq_sorted.bam)  \r\n- [mega_array_seq_sorted.bam.bai](https://s3-eu-west-1.amazonaws.com/illumina-probe-mappings/mega_array_seq_sorted.bam.bai)  \r\n\r\n**OMNI**  \r\n- ...   \r\n- ...     \r\n\r\n### Probe Lists  \r\nThese lists provide data on probe mappings. We provide Illumina Probe Id's along with the\r\nnumber of time it maps to the genome. \r\n\r\n| BeadArry | probe mapping | good probes|\r\n|-----|-----------|-------------------------|\r\n| MEGA\\_Consortium\\_15063755_B2 | [xxx]()| [xxx]()| \r\n| HumanOmniExpressExome-8 v1.1 | [xxx]()| [xxx]()| \r\n| HumanOmniExpress-24 v1.1 |[xxx]()| [xxx]()|  \r\n| HumanOmniExpress-24 v1.0 |[xxx]()| [xxx]()|  \r\n| HumanCoreExome-24 v1.0 |[xxx]()|[xxx]()|\r\n\r\n\r\n### Table 1. Number of variants after probe mapping\r\n\r\n| BeadArry | N SNP Start |N SNP End |\r\n|-----|-----------|-------------------------|\r\n| MEGA\\_Consortium\\_15063755_B2 | 1.7m| 1.5m| \r\n| HumanOmniExpressExome-8 v1.1 | ?| ?| \r\n| HumanOmniExpress-24 v1.1 |?| ?|  \r\n| HumanOmniExpress-24 v1.0 |?| ?|  \r\n| HumanCoreExome-24 v1.0 |?|?|\r\n\r\n## 2. Genomestudio \r\n\r\n- Manual clustering, inspection and filtering of variants in genomestudio\r\n- ensures that the most robust data is produced\r\n- allows iterative qc of samples and snps and ability to rescue data close to qc thresholds for exclusion\r\n- for each array we cluster variants based on data and generate new custom egt files \r\n- custom egt files used for all subsequent projects\r\n\r\nMore details soon....\r\n\r\n## 3. Quality Control and Re-Calling  \r\n\r\n- data exported and processed using [custom scripts]()\r\n- standard gwas qc \r\n   - sample & snp call rates\r\n   - IBD \r\n   - het if requested\r\n   - maf & hwe if requested\r\n   - gender checks if requested and if gender provided\r\n   - No PCA or MDS (this is for the data owners to do)\r\n- No-Call Variants recalled using zCall\r\n- Produce PLINK Files for further analysis by data owners \r\n\r\nMore details soon....\r\n\r\n******\r\n\r\n### No. Genotypes and Samples Processed  \r\n\r\n| Samples/SNPs | Total |\r\n|-----|-----------|\r\n| Samples | 10000 |\r\n| SNPS | 1000000000| \r\n\r\n******\r\nCopyright (C) 2015 Hamel Patel, Amos Folarin & Stephen Jeffrey Newhouse\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}